# Tegra Security Key Generation Tool

This tool generates security keys for NVIDIA Tegra platforms, including RSA keys, Secure Boot Keys (SBK), Key Encryption Keys (KEK), and UEFI secure boot keys.

## Prerequisites

- Linux environment
- Python 3.x
- OpenSSL
- UEFI tools (cert-to-efi-sig-list, uuid-gen)
- NVIDIA Jetpack SDK tools

## Directory Structure

The tool expects the following directory structure:
```
.
├── JP/
│   └── Linux_for_Tegra/
│       ├── bootloader/
│       │   └── tegrasign_v3.py
│       ├── tools/
│       │   └── gen_uefi_keys_dts.sh
│       └── source/
│           └── optee/
│               └── samples/
│                   └── hwkey-agent/
│                       └── host/
│                           └── tool/
│                               └── gen_ekb/
│                                   └── gen_ekb.py
```

## Setup

1. Clone this repository
2. Run the preparation step to create a Python virtual environment:

```bash
make prep
```

## Usage

To generate all security keys:

```bash
make
```

If keys already exist, you'll be prompted to confirm overwriting them or to run `make clean` first.

To clean all generated files:

```bash
make clean
```

## Generated Keys

The tool generates the following keys:

- **RSA Keys**: Used for secure boot signature verification
- **SBK (Secure Boot Key)**: Used for encryption of boot components
- **KEK (Key Encryption Key)**: Used for encrypting other keys in the system
- **Symmetric Keys**: Used for various encryption operations
- **UEFI Secure Boot Keys**:
  - PK (Platform Key): The root of trust
  - KEK (Key Exchange Key): Used to update the signature database
  - db (Signature Database): Contains keys that are allowed to boot

## Output Files

- `rsa.pem`: RSA private key
- `rsa.pubkey`: RSA public key
- `rsa.hash`: RSA public key hash
- `sbk.key`, `sbk_xml.key`: Secure Boot Key in different formats
- `kek.key`, `kek_xml.key`, `kek_optee.key`: Key Encryption Key in different formats
- `sym_t234.key`, `sym2_t234.key`, `auth_t234.key`: Symmetric keys
- `fuse.xml`: Fuse programming XML file
- `uefi_keys/`: Directory containing UEFI secure boot keys
- `bootloader/eks_t234.img`: OP-TEE encrypted key blob image

## Security Warning

The keys generated by this tool are critical security components. In a production environment:

- Generate keys on a secure, air-gapped system
- Store keys securely with appropriate access controls
- Never share private keys or fuse values
